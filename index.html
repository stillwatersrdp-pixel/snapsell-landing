<!DOCTYPE html>
<html lang="zh-TW">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>SnapSell App - AI è‡ªå‹•ä¸Šæ¶ç³»çµ±</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script type="importmap">

      {

        "imports": {

          "@google/generative-ai": "https://esm.run/@google/generative-ai"

        }

      }

    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>

        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }

        .loader {

            border: 3px solid #f3f3f3;

            border-radius: 50%;

            border-top: 3px solid #4f46e5;

            width: 24px;

            height: 24px;

            -webkit-animation: spin 1s linear infinite; /* Safari */

            animation: spin 1s linear infinite;

        }

        @keyframes spin {

            0% { transform: rotate(0deg); }

            100% { transform: rotate(360deg); }

        }

        .ai-sparkle {

            animation: pulse 2s infinite;

        }

        @keyframes pulse {

            0% { opacity: 0.5; }

            50% { opacity: 1; }

            100% { opacity: 0.5; }

        }

    </style>

</head>

<body class="h-screen flex flex-col md:flex-row overflow-hidden">



    <!-- å·¦å´ï¼šæ§åˆ¶å° -->

    <div class="w-full md:w-1/3 bg-white border-r border-gray-200 flex flex-col h-full overflow-y-auto z-10 shadow-lg">

        <div class="p-6 border-b border-gray-100">

            <h1 class="text-2xl font-bold text-indigo-600 flex items-center gap-2">

                SnapSell <span class="text-xs bg-indigo-100 text-indigo-600 px-2 py-1 rounded-full">Pro</span>

            </h1>

            <p class="text-sm text-gray-500 mt-1">AI æ¥µé€Ÿä¸Šæ¶å·¥å…·</p>

        </div>



        <div class="p-6 flex-1 space-y-6">

            

            <!-- API Key è¼¸å…¥ (ç‚ºäº†æ¼”ç¤ºæ–¹ä¾¿ç›´æ¥åšåœ¨å‰ç«¯) -->

            <div>

                <label class="block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">1. è¨­å®š AI é‡‘é‘°</label>

                <input type="password" id="apiKey" placeholder="è²¼ä¸Šä½ çš„ Google Gemini API Key" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none transition">

                <p class="text-xs text-gray-400 mt-1">éœ€è¦ Key æ‰èƒ½é©…å‹• AI è­˜åˆ¥ (è³‡æ–™åƒ…å­˜åœ¨ç€è¦½å™¨)</p>

            </div>



            <!-- ä¸Šå‚³å€ -->

            <div>

                <label class="block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">2. ä¸Šå‚³å•†å“ç…§</label>

                <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:bg-gray-50 transition cursor-pointer relative" id="dropZone">

                    <input type="file" id="imageInput" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">

                    <div id="uploadPlaceholder">

                        <div class="text-4xl mb-2">ğŸ“¸</div>

                        <p class="text-sm font-medium text-gray-600">é»æ“Šæˆ–æ‹–æ›³ç…§ç‰‡è‡³æ­¤</p>

                        <p class="text-xs text-gray-400 mt-1">AI å°‡è‡ªå‹•ä¿®åœ–èˆ‡æ’°å¯«æ–‡æ¡ˆ</p>

                    </div>

                    <img id="previewImage" class="hidden max-h-48 mx-auto rounded-lg shadow-sm object-contain">

                </div>

            </div>



            <!-- AI è¨­å®š -->

            <div id="processSection" class="opacity-50 pointer-events-none transition-opacity duration-300">

                <label class="block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">3. AI è™•ç†é¸é …</label>

                <div class="space-y-3">

                    <label class="flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-indigo-50 border-indigo-200 bg-indigo-50">

                        <input type="checkbox" checked class="text-indigo-600 focus:ring-indigo-500 h-4 w-4 rounded">

                        <span class="text-sm text-gray-700 font-medium">æ™ºèƒ½å»èƒŒèˆ‡ä¿®æ•´é›œç‰©</span>

                    </label>

                    <label class="flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-indigo-50 border-indigo-200 bg-indigo-50">

                        <input type="checkbox" checked class="text-indigo-600 focus:ring-indigo-500 h-4 w-4 rounded">

                        <span class="text-sm text-gray-700 font-medium">ç”Ÿæˆ SEO æ¨™é¡Œèˆ‡æè¿°</span>

                    </label>

                    <label class="flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-indigo-50 border-indigo-200 bg-indigo-50">

                        <input type="checkbox" checked class="text-indigo-600 focus:ring-indigo-500 h-4 w-4 rounded">

                        <span class="text-sm text-gray-700 font-medium">æŸ¥è©¢å¸‚å ´è¡Œæƒ…ä¼°åƒ¹</span>

                    </label>

                </div>



                <button id="generateBtn" class="w-full mt-6 bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-bold shadow-lg hover:shadow-xl transition transform hover:-translate-y-0.5 flex items-center justify-center gap-2">

                    <span id="btnText">âœ¨ é–‹å§‹ AI ç”Ÿæˆ</span>

                    <div id="btnLoader" class="loader hidden border-white border-t-transparent"></div>

                </button>

            </div>

        </div>

    </div>



    <!-- å³å´ï¼šå³æ™‚é è¦½å€ -->

    <div class="flex-1 bg-gray-100 p-4 md:p-10 overflow-y-auto relative">

        <div class="max-w-2xl mx-auto">

            <div class="flex justify-between items-center mb-6">

                <h2 class="text-xl font-bold text-gray-700">ç”Ÿæˆçµæœé è¦½</h2>

                <span class="text-sm text-gray-500" id="statusText">ç­‰å¾…ä¸Šå‚³...</span>

            </div>



            <!-- æ‹è³£é é¢å¡ç‰‡ -->

            <div class="bg-white rounded-2xl shadow-xl overflow-hidden min-h-[600px] relative transition-all duration-500" id="listingCard">

                

                <!-- é®ç½©å±¤ (ç­‰å¾…ä¸­) -->

                <div id="loadingOverlay" class="absolute inset-0 bg-white/80 backdrop-blur-sm z-20 flex flex-col items-center justify-center hidden">

                    <div class="text-6xl mb-4 ai-sparkle">ğŸ¤–</div>

                    <h3 class="text-xl font-bold text-gray-800 mb-2">AI æ­£åœ¨å·¥ä½œä¸­...</h3>

                    <p class="text-gray-500 text-sm" id="loadingStep">æ­£åœ¨åˆ†æåœ–ç‰‡è¦–è¦ºç‰¹å¾µ...</p>

                </div>



                <!-- é€™è£¡æ˜¯ç”¨ä¾†é¡¯ç¤º AI ç”Ÿæˆåœ–ç‰‡çš„å€åŸŸ (æ¨¡æ“¬) -->

                <div class="w-full h-80 bg-gray-200 relative group overflow-hidden">

                    <img id="resultImage" src="https://placehold.co/800x600?text=Waiting+For+Image" class="w-full h-full object-cover">

                    <div class="absolute top-4 right-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold text-indigo-600 shadow-sm">

                        âœ¨ AI Enhanced

                    </div>

                </div>



                <div class="p-8">

                    <!-- æ¨™é¡Œèˆ‡åƒ¹æ ¼ -->

                    <div class="flex justify-between items-start mb-4">

                        <div class="flex-1 mr-4">

                            <input type="text" id="outTitle" class="w-full text-2xl font-bold text-gray-800 border-none focus:ring-0 p-0 placeholder-gray-300" placeholder="ç­‰å¾… AI ç”Ÿæˆæ¨™é¡Œ..." value="[AI å°‡è‡ªå‹•å¡«å¯«æ¨™é¡Œ]">

                            <div class="mt-2 flex gap-2" id="outTags">

                                <!-- Tags will go here -->

                                <span class="bg-gray-100 text-gray-400 text-xs px-2 py-1 rounded">Tag</span>

                            </div>

                        </div>

                        <div class="text-right">

                            <p class="text-xs text-gray-400 mb-1">å»ºè­°å”®åƒ¹</p>

                            <div class="flex items-center text-3xl font-bold text-red-500">

                                $<input type="text" id="outPrice" class="w-24 text-right border-none focus:ring-0 p-0 text-red-500 placeholder-red-200" value="0">

                            </div>

                        </div>

                    </div>



                    <hr class="border-gray-100 my-6">



                    <!-- è©³ç´°æè¿° -->

                    <div class="space-y-4">

                        <h4 class="font-bold text-gray-700">å•†å“æè¿°</h4>

                        <textarea id="outDescription" rows="8" class="w-full text-gray-600 leading-relaxed border-gray-200 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="AI å°‡æ ¹æ“šç…§ç‰‡è‡ªå‹•æ’°å¯«è©³ç´°çš„æè³ªã€å°ºå¯¸ã€ç‹€æ³æè¿°..."></textarea>

                    </div>



                    <!-- è¦æ ¼å±¬æ€§ -->

                    <div class="mt-6 bg-gray-50 rounded-xl p-4 grid grid-cols-2 gap-4 text-sm" id="outAttributes">

                        <!-- Attributes will go here -->

                        <div><span class="text-gray-400">é¡åˆ¥ï¼š</span> <span class="text-gray-800 font-medium">ç­‰å¾…åˆ†æ</span></div>

                        <div><span class="text-gray-400">æè³ªï¼š</span> <span class="text-gray-800 font-medium">ç­‰å¾…åˆ†æ</span></div>

                        <div><span class="text-gray-400">é¡è‰²ï¼š</span> <span class="text-gray-800 font-medium">ç­‰å¾…åˆ†æ</span></div>

                        <div><span class="text-gray-400">ç‹€æ³ï¼š</span> <span class="text-gray-800 font-medium">ç­‰å¾…åˆ†æ</span></div>

                    </div>



                    <!-- åº•éƒ¨æŒ‰éˆ• -->

                    <div class="mt-8 flex gap-4">

                        <button class="flex-1 bg-indigo-600 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-indigo-700 transition">ç¢ºèªç™¼å¸ƒä¸Šæ¶</button>

                        <button class="px-6 border border-gray-300 rounded-xl font-medium text-gray-600 hover:bg-gray-50">å„²å­˜è‰ç¨¿</button>

                    </div>

                </div>

            </div>

        </div>

    </div>



    <!-- é‚è¼¯è™•ç† -->

    <script type="module">

        import { GoogleGenerativeAI } from "@google/generative-ai";



        const imageInput = document.getElementById('imageInput');

        const previewImage = document.getElementById('previewImage');

        const uploadPlaceholder = document.getElementById('uploadPlaceholder');

        const processSection = document.getElementById('processSection');

        const generateBtn = document.getElementById('generateBtn');

        const resultImage = document.getElementById('resultImage');

        

        let uploadedFile = null;



        // 1. è™•ç†åœ–ç‰‡ä¸Šå‚³é è¦½

        imageInput.addEventListener('change', function(e) {

            const file = e.target.files[0];

            if (!file) return;

            

            uploadedFile = file;

            const reader = new FileReader();

            reader.onload = function(e) {

                previewImage.src = e.target.result;

                resultImage.src = e.target.result; // åŒæ­¥åˆ°å³å´

                previewImage.classList.remove('hidden');

                uploadPlaceholder.classList.add('hidden');

                processSection.classList.remove('opacity-50', 'pointer-events-none');

                document.getElementById('statusText').innerText = "åœ–ç‰‡å·²å°±ç·’";

            }

            reader.readAsDataURL(file);

        });



        // 2. è½‰æ› File ç‚º Base64 (çµ¦ Gemini ç”¨)

        async function fileToGenerativePart(file) {

            const base64EncodedDataPromise = new Promise((resolve) => {

                const reader = new FileReader();

                reader.onloadend = () => resolve(reader.result.split(',')[1]);

                reader.readAsDataURL(file);

            });

            return {

                inlineData: { data: await base64EncodedDataPromise, mimeType: file.type },

            };

        }



        // 3. AI æ ¸å¿ƒé‚è¼¯

        generateBtn.addEventListener('click', async () => {

            const apiKey = document.getElementById('apiKey').value;

            if (!apiKey) {

                alert("è«‹å…ˆè¼¸å…¥ API Key æ‰èƒ½ä½¿ç”¨ AI åŠŸèƒ½ï¼");

                return;

            }



            // UI ç‹€æ…‹åˆ‡æ›

            const loader = document.getElementById('loadingOverlay');

            const btnText = document.getElementById('btnText');

            const btnLoader = document.getElementById('btnLoader');

            const stepText = document.getElementById('loadingStep');



            loader.classList.remove('hidden');

            generateBtn.disabled = true;

            btnText.innerText = "è™•ç†ä¸­...";

            btnLoader.classList.remove('hidden');



            try {

                // åˆå§‹åŒ– Gemini

                const genAI = new GoogleGenerativeAI(apiKey);

                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });



                const imagePart = await fileToGenerativePart(uploadedFile);



                const prompt = `

                    ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„é›»å•†æ‹è³£å°ˆå®¶ã€‚è«‹åˆ†æé€™å¼µåœ–ç‰‡ï¼Œä¸¦ç”¢ç”Ÿ JSON æ ¼å¼çš„å›æ‡‰ã€‚

                    

                    è«‹å¿½ç•¥èƒŒæ™¯é›œç‰©ï¼Œå°ˆæ³¨æ–¼å•†å“ä¸»é«”ã€‚

                    

                    è«‹å›å‚³ä»¥ä¸‹æ¬„ä½ï¼š

                    1. title: å¸å¼•äººçš„ SEO æ¨™é¡Œ (åŒ…å«å“ç‰Œã€å‹è™Ÿã€ç‰¹é»)

                    2. price: ä¼°è¨ˆçš„äºŒæ‰‹å¸‚å ´åƒ¹æ ¼ (å°å¹£ï¼Œåªè¦æ•¸å­—)

                    3. description: è©³ç´°çš„å•†å“æè¿° (åŒ…å«å¤–è§€ç‹€æ³ã€æè³ªã€é©åˆå ´æ™¯ï¼Œèªæ°£è¦è¦ªåˆ‡å°ˆæ¥­ï¼Œåˆ†æ®µè½)

                    4. category: å•†å“é¡åˆ¥

                    5. material: æè³ª

                    6. color: é¡è‰²

                    7. condition: å¤–è§€ç‹€æ³ (ä¾‹å¦‚ï¼š9æˆæ–°ã€å…¨æ–°)

                    8. tags: 5å€‹ç›¸é—œçš„ hashtags (é™£åˆ—)



                    è«‹ç›´æ¥å›å‚³ JSON å­—ä¸²ï¼Œä¸è¦æœ‰ Markdown æ¨™è¨˜ã€‚

                `;



                // æ¨¡æ“¬æ­¥é©Ÿ 1: ä¿®åœ– (é€™è£¡ç”¨ setTimeout æ¨¡æ“¬ï¼Œå› ç‚ºçœŸå¯¦ä¿®åœ– API éœ€ä»˜è²»)

                stepText.innerText = "æ­£åœ¨ç§»é™¤èƒŒæ™¯é›œç‰©èˆ‡ä¿®æ•´å…‰å½±...";

                await new Promise(r => setTimeout(r, 2000));

                

                // æ¨¡æ“¬ä¿®åœ–æ•ˆæœï¼šç¨å¾®èª¿äº®ä¸€é»ï¼Œè®“ä½¿ç”¨è€…æœ‰æ„Ÿè¦ºè®Šäº†

                resultImage.style.filter = "brightness(1.1) contrast(1.1)";



                // æ­¥é©Ÿ 2: è­˜åˆ¥èˆ‡å¯«ä½œ

                stepText.innerText = "AI æ­£åœ¨è­˜åˆ¥å•†å“ç‰¹å¾µèˆ‡æ’°å¯«æ–‡æ¡ˆ...";

                

                const result = await model.generateContent([prompt, imagePart]);

                const response = await result.response;

                let text = response.text();

                

                // æ¸…ç† JSON æ ¼å¼ (Gemini æœ‰æ™‚æœƒåŒ… markdown)

                text = text.replace(/```json/g, '').replace(/```/g, '').trim();

                const data = JSON.parse(text);



                // å¡«å…¥è³‡æ–™

                document.getElementById('outTitle').value = data.title;

                document.getElementById('outPrice').value = data.price;

                document.getElementById('outDescription').value = data.description;

                

                // å¡«å…¥ Tags

                const tagsHtml = data.tags.map(tag => `<span class="bg-indigo-100 text-indigo-600 text-xs px-2 py-1 rounded">#${tag}</span>`).join('');

                document.getElementById('outTags').innerHTML = tagsHtml;



                // å¡«å…¥å±¬æ€§

                const attrHtml = `

                    <div><span class="text-gray-400">é¡åˆ¥ï¼š</span> <span class="text-gray-800 font-medium">${data.category}</span></div>

                    <div><span class="text-gray-400">æè³ªï¼š</span> <span class="text-gray-800 font-medium">${data.material}</span></div>

                    <div><span class="text-gray-400">é¡è‰²ï¼š</span> <span class="text-gray-800 font-medium">${data.color}</span></div>

                    <div><span class="text-gray-400">ç‹€æ³ï¼š</span> <span class="text-gray-800 font-medium">${data.condition}</span></div>

                `;

                document.getElementById('outAttributes').innerHTML = attrHtml;



                document.getElementById('statusText').innerText = "AI ç”Ÿæˆå®Œæˆ";



            } catch (error) {

                console.error(error);

                alert("ç™¼ç”ŸéŒ¯èª¤ï¼š" + error.message + "\nè«‹æª¢æŸ¥ API Key æ˜¯å¦æ­£ç¢ºæˆ–ç¶²è·¯ç‹€æ³ã€‚");

            } finally {

                // æ¢å¾© UI

                loader.classList.add('hidden');

                generateBtn.disabled = false;

                btnText.innerText = "âœ¨ é‡æ–°ç”Ÿæˆ";

                btnLoader.classList.add('hidden');

            }

        });

    </script>

</body>

</html>
